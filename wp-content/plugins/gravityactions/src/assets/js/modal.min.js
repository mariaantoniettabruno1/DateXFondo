GravityKit.GravityActions.Modal={},function($,obj,_){"use strict";String.prototype.className=function(){return"string"!=typeof this&&!this instanceof String||"function"!=typeof this.replace?this:this.replace(".","")},obj.$document=$(document),obj.featherlight=null,obj.selectors={modal:".gk-gravityactions-modal",container:'[data-js="gk-gravityactions-modal-container"]',link:'[data-js="gk-gravityactions-modal-link"]',form:'[data-js="gk-gravityactions-modal-form"]',submit:'[data-js="gk-gravityactions-modal-submit"]',submitClicked:".gk-gravityactions-modal-submit-clicked",loader:".gk-gravityactions-loading",hiddenElement:".gk-gravityactions-hidden"},obj.doingPopstate=!1,obj.currentAjaxRequest=null,obj.ready=function(){$(document).on("click.GravityActions/GK",obj.selectors.link,obj.onClickOpen),$(document).on("submit.GravityActions/GK",obj.selectors.form,obj.onFormSubmit),$(document).on("click.GravityActions/GK",obj.selectors.submit,obj.onSubmitClick)},obj.onClickOpen=function(event){return obj.request({$trigger:$(this)}),event.preventDefault(),!1},obj.onSubmitClick=function(event){$(this).addClass(obj.selectors.submitClicked.className())},obj.onFormSubmit=function(event){const $form=$(this),$submitter=$form.find(obj.selectors.submitClicked);let data=new FormData($form[0]);return(data=obj.serializeFormData(data)).$trigger=$submitter,obj.request(data),$submitter.removeClass(obj.selectors.submitClicked.className()),event.preventDefault(),!1},obj.serializeFormData=function(data){let obj={};for(let[key,value]of data)void 0!==obj[key]?(Array.isArray(obj[key])||(obj[key]=[obj[key]]),obj[key].push(value)):obj[key]=value;return obj},obj.openModal=function(){let modalConfig={variant:obj.selectors.modal.className(),closeIcon:"",afterClose:obj.onModalClose};obj.featherlight=$.featherlight('<div class="gk-gravityactions-modal-inner"></div>',modalConfig)},obj.insertLoader=function(){const $loader=$('<div class="gk-gravityactions-modal-loader"><div class="gk-gravityactions-modal-loader-spinner"><div></div><div></div><div></div><div></div></div></div>');obj.featherlight.$content.append($loader)},obj.request=function(data){obj.featherlight||obj.openModal(),obj.featherlight.$instance.trigger("beforeRequest.GravityActions/GK",[data]);let settings=obj.getAjaxSettings();settings.data=obj.setupRequestData(data),obj.currentAjaxRequest=$.ajax(settings),obj.featherlight.$instance.trigger("afterRequest.GravityActions/GK",[data])},obj.setupRequestData=function(data){let $trigger;void 0!==data.$trigger&&($trigger=data.$trigger,delete data.$trigger);let defaultData={action:"gk-gravityactions/modal"};return $trigger&&(defaultData.view=$trigger.data("modalView")),$.extend({},defaultData,data)},obj.getAjaxSettings=function(){return{url:ajaxurl,accepts:"html",dataType:"html",method:"POST",async:!0,beforeSend:obj.ajaxBeforeSend,complete:obj.ajaxComplete,success:obj.ajaxSuccess,error:obj.ajaxError,context:obj.featherlight.$instance}},obj.ajaxBeforeSend=function(jqXHR,settings){obj.insertLoader();var $loader=this.find(obj.selectors.loader);this.trigger("beforeAjaxBeforeSend.GravityActions/GK",[jqXHR,settings]),$loader.length&&$loader.removeClass(obj.selectors.hiddenElement.className()),this.trigger("afterAjaxBeforeSend.GravityActions/GK",[jqXHR,settings])},obj.ajaxComplete=function(jqXHR,textStatus){var $loader=this.find(obj.selectors.loader);this.trigger("beforeAjaxComplete.GravityActions/GK",[jqXHR,textStatus]),$loader.length&&$loader.addClass(obj.selectors.hiddenElement.className()),this.trigger("afterAjaxComplete.GravityActions/GK",[jqXHR,textStatus]),obj.doingPopstate&&(obj.doingPopstate=!1),obj.currentAjaxRequest=null},obj.ajaxSuccess=function(data,textStatus,jqXHR){this.trigger("beforeAjaxSuccess.GravityActions/GK",[data,textStatus,jqXHR]);var $html=$(data);obj.featherlight.$content.empty().append($html),this.trigger("afterAjaxSuccess.GravityActions/GK",[data,textStatus,jqXHR])},obj.ajaxError=function(jqXHR,settings){this.trigger("beforeAjaxError.GravityActions/GK",[jqXHR,settings]),obj.featherlight.close(),this.trigger("afterAjaxError.GravityActions/GK",[jqXHR,settings])},obj.onModalClose=function(){obj.featherlight.$instance.trigger("beforeCloseModal.GravityActions/GK",[this]),obj.featherlight=null},$(obj.ready)}(jQuery,GravityKit.GravityActions.Modal,window._);